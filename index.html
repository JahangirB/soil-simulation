<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soil Settlement Presentation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        html, body {
            height: 100%;
            margin: 0;
            font-family: 'Inter', sans-serif;
        }
        main {
            width: 100%;
            height: 100%;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease-in-out, visibility 0.5s ease-in-out;
            overflow-y: auto; /* Allow scrolling on individual slides if content overflows */
            padding: 2rem;
        }
        .slide.active {
            opacity: 1;
            visibility: visible;
            z-index: 10;
        }
        .nav-button {
            position: fixed;
            bottom: 2rem;
            z-index: 100;
            padding: 0.75rem 1.5rem;
            background-color: #4f46e5;
            color: white;
            border-radius: 9999px;
            font-weight: bold;
            box-shadow: 0 4px 14px 0 rgba(0, 0, 0, 0.25);
            transition: all 0.2s ease-in-out;
        }
        .nav-button:hover {
            background-color: #4338ca;
            transform: translateY(-2px);
        }
        #prev { left: 2rem; }
        #next { right: 2rem; }
        
        #draggable-magnet {
            cursor: grab;
        }
        #draggable-magnet:active {
            cursor: grabbing;
        }

        /* New Table Styles */
        .table-container {
            background-color: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .data-table {
            width: 100%;
            text-align: left;
            border-collapse: collapse;
        }
        .data-table thead {
            border-bottom: 2px solid #d1d5db;
        }
        .data-table th {
            padding: 0.75rem 1rem;
            font-weight: 600;
            color: #374151;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-size: 0.75rem;
        }
        .data-table td {
            padding: 0.75rem 1rem;
            color: #4b5563;
            border-top: 1px solid #e5e7eb;
        }
        .data-table tbody tr:first-child td {
            border-top: none;
        }

        /* Installation Diagram Styles */
        .installation-step-description {
            position: absolute;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            visibility: hidden;
        }
        .installation-step-description.active {
            opacity: 1;
            visibility: visible;
        }
        .installation-diagram-element {
            transition: all 0.5s ease-in-out;
        }

        /* Component Movement Slide Styles */
        .component-button {
            transition: all 0.2s ease-in-out;
        }
        .component-button.active {
            background-color: #4f46e5;
            color: white;
            transform: scale(1.05);
        }
        .highlighted-component {
            filter: drop-shadow(0px 0px 10px #fde047);
        }
    </style>
</head>
<body class="bg-gray-100">

    <main>
        <!-- Slide 1: Title -->
        <div id="slide-1" class="slide active">
            <div class="p-4">
                <h1 class="text-6xl font-black text-gray-800">Interactive Soil Settlement Simulation</h1>
                <p class="mt-4 text-2xl text-gray-600">Visualizing the Effects of Embankment Loading on Clay Soil</p>
            </div>
        </div>

        <!-- Slide 2: Introduction -->
        <div id="slide-2" class="slide">
             <div class="p-4">
                <h1 class="text-5xl font-bold text-gray-800">Simulation Setup</h1>
                <ul class="mt-8 text-xl text-left list-disc space-y-4 max-w-3xl">
                    <li>Model simulates a uniform clay soil layer under an embankment load.</li>
                    <li>A magnetic extensometer is installed to monitor soil movement.</li>
                    <li>Spider Magnets (1, 2, 3) move with the surrounding soil.</li>
                    <li>The Datum (D) is a fixed anchor point in stable ground.</li>
                    <li>We will observe both <span class="font-bold text-indigo-600">instrument readings</span> and the <span class="font-bold text-green-700">actual physical settlement</span>.</li>
                </ul>
            </div>
        </div>

        <!-- Slide 3: How the Probe Works -->
        <div id="slide-3" class="slide">
            <div class="w-full max-w-6xl flex flex-col md:flex-row items-center justify-center gap-8 p-4">
                <div class="w-full md:w-1/2 text-left">
                    <h1 class="text-5xl font-bold text-gray-800">How the Probe Works</h1>
                    <ul class="mt-8 text-xl text-left list-disc space-y-4">
                        <li>The automated probe is a metal bar, approximately 600mm in length.</li>
                        <li>Inside, a <span class="font-bold text-red-600">400mm sensor</span> actively detects magnetic fields.</li>
                        <li>When a magnet enters this sensor range (0mm to 400mm), its exact position is identified.</li>
                        <li>This position is sent as a signal to the data logger. If the magnet is outside this range, no data is recorded.</li>
                    </ul>
                    <div class="mt-8 p-4 bg-indigo-100 border-l-4 border-indigo-500 text-indigo-700 rounded-r-lg">
                        <p class="font-bold">Interactive Element</p>
                        <p>Drag the blue magnet on the right to see how the instrument reading changes in real-time.</p>
                    </div>
                    <img src="probe_image.png" alt="A real-world automated magnetic extensometer probe" class="mt-8 rounded-lg shadow-md border border-gray-200 w-full max-w-md mx-auto md:mx-0">
                </div>
                <div class="w-full md:w-1/2 flex items-center justify-center">
                    <svg id="probe-svg" viewBox="0 0 400 700" class="w-full h-full max-w-sm">
                        <!-- Probe Body -->
                        <rect x="150" y="50" width="30" height="600" fill="#a0aec0" rx="5"/>
                        <!-- Sensor Area -->
                        <rect x="155" y="150" width="20" height="400" fill="#f56565" rx="3"/>
                        
                        <!-- Markings -->
                        <g class="text-gray-700 font-semibold">
                            <text x="190" y="155">0 mm</text><line x1="180" y1="150" x2="185" y2="150" stroke="currentColor"/>
                            <text x="190" y="255">100 mm</text><line x1="180" y1="250" x2="185" y2="250" stroke="currentColor"/>
                            <text x="190" y="355">200 mm</text><line x1="180" y1="350" x2="185" y2="350" stroke="currentColor"/>
                            <text x="190" y="455">300 mm</text><line x1="180" y1="450" x2="185" y2="450" stroke="currentColor"/>
                            <text x="190" y="555">400 mm</text><line x1="180" y1="550" x2="185" y2="550" stroke="currentColor"/>
                        </g>

                        <!-- Draggable Magnet -->
                        <g id="draggable-magnet" transform="translate(0, 150)">
                            <circle cx="120" cy="150" r="15" fill="#4299e1" stroke="white" stroke-width="2"/>
                            <text x="120" y="155" text-anchor="middle" fill="white" font-weight="bold">M</text>
                        </g>
                        
                        <!-- Readout Dial -->
                        <g transform="translate(320, 350)">
                            <circle cx="0" cy="0" r="70" fill="white" stroke="#e2e8f0" stroke-width="4"/>
                            <text x="0" y="-20" text-anchor="middle" class="font-semibold">Reading</text>
                            <text id="probe-readout" x="0" y="15" text-anchor="middle" class="text-3xl font-bold text-indigo-600">0 mm</text>
                        </g>
                    </svg>
                </div>
            </div>
        </div>

        <!-- Slide 4: Installation Process -->
        <div id="slide-4" class="slide">
             <div class="w-full max-w-6xl flex flex-col md:flex-row items-center justify-center gap-12 p-4">
                <div class="w-full md:w-1/2 text-left">
                    <h1 class="text-5xl font-bold text-gray-800">Installation Process</h1>
                    <div class="mt-8 text-xl text-left space-y-4 relative h-64">
                        <div id="step-desc-1" class="installation-step-description active">
                             <h2 class="font-bold text-2xl">Step 1: Drill Borehole</h2>
                             <p>A borehole is drilled into the ground to the required depth, passing through all soil layers to be monitored.</p>
                        </div>
                         <div id="step-desc-2" class="installation-step-description">
                             <h2 class="font-bold text-2xl">Step 2: Install & Grout Casing</h2>
                             <p>An access casing is lowered into the borehole. The space between the casing and the borehole wall is then filled with grout to stabilize the ground.</p>
                        </div>
                         <div id="step-desc-3" class="installation-step-description">
                             <h2 class="font-bold text-2xl">Step 3: Install Magnets</h2>
                             <p>Using an installation tool, spider magnets are pushed down inside the casing. At each target depth, the tool deploys the magnet's legs to anchor it to the borehole wall.</p>
                        </div>
                         <div id="step-desc-4" class="installation-step-description">
                             <h2 class="font-bold text-2xl">Step 4: Install Probe & Commission</h2>
                             <p>Finally, the automated probe string is lowered into the empty casing and connected to a data logger to take initial baseline readings.</p>
                        </div>
                    </div>
                     <div class="mt-8 flex gap-4">
                        <button id="prev-install-step" class="px-6 py-2 bg-gray-300 text-gray-800 font-semibold rounded-lg shadow">Previous Step</button>
                        <button id="next-install-step" class="px-6 py-2 bg-indigo-600 text-white font-semibold rounded-lg shadow">Next Step</button>
                    </div>
                </div>
                <div class="w-full md:w-1/2 flex items-center justify-center h-96">
                   <svg id="installation-svg" viewBox="0 0 400 400" class="h-full">
                        <!-- Ground -->
                        <rect x="0" y="50" width="400" height="350" fill="#a67b51"/>
                        <rect x="0" y="45" width="400" height="5" fill="#4d7c0f"/>

                        <!-- Borehole -->
                        <rect id="borehole" x="150" y="50" width="100" height="350" fill="#6b4624"/>

                        <!-- Drill -->
                        <g id="drill" class="installation-diagram-element" transform="translate(200, -100)">
                            <rect x="-10" y="0" width="20" height="80" fill="#d1d5db"/>
                            <path d="M -10 80 L 0 100 L 10 80 Z" fill="#7f1d1d"/>
                        </g>

                        <!-- Grout -->
                        <rect id="grout-left" class="installation-diagram-element" x="150" y="50" width="30" height="350" fill="#e5e7eb" opacity="0"/>
                        <rect id="grout-right" class="installation-diagram-element" x="220" y="50" width="30" height="350" fill="#e5e7eb" opacity="0"/>
                        
                        <!-- Deployed Magnets -->
                        <g id="deployed-magnets" class="installation-diagram-element" opacity="0">
                            <g transform="translate(200, 385)"> <rect x="-25" y="-5" width="50" height="10" fill="#065f46" stroke="#4a5568"/><path d="M -25 0 L -50 -25" stroke="#4a5568" stroke-width="2"/><path d="M 25 0 L 50 -25" stroke="#4a5568" stroke-width="2"/></g>
                            <g transform="translate(200, 265)"><rect x="-25" y="-5" width="50" height="10" fill="#065f46" stroke="#4a5568"/><path d="M -25 0 L -50 -25" stroke="#4a5568" stroke-width="2"/><path d="M 25 0 L 50 -25" stroke="#4a5568" stroke-width="2"/></g>
                        </g>
                        
                        <!-- Casing -->
                        <rect id="install-casing" class="installation-diagram-element" x="180" y="50" width="40" height="350" fill="#2563eb" stroke="#1e3a8a" style="transform: translateY(-400px)" />

                        <!-- Installation Tool -->
                        <g id="install-tool" class="installation-diagram-element" transform="translate(200, -350)">
                            <rect x="-5" y="0" width="10" height="350" fill="#9ca3af"/>
                            <g id="install-magnet-1" transform="translate(0, 335)"><rect x="-15" y="-5" width="30" height="10" fill="#065f46" stroke="#4a5568"/><path id="leg-1-left" class="installation-diagram-element" d="M -15 0 L -25 0" stroke="#4a5568" stroke-width="2"/><path id="leg-1-right" class="installation-diagram-element" d="M 15 0 L 25 0" stroke="#4a5568" stroke-width="2"/></g>
                            <g id="install-magnet-2" transform="translate(0, 215)"><rect x="-15" y="-5" width="30" height="10" fill="#065f46" stroke="#4a5568"/><path id="leg-2-left" class="installation-diagram-element" d="M -15 0 L -25 0" stroke="#4a5568" stroke-width="2"/><path id="leg-2-right" class="installation-diagram-element" d="M 15 0 L 25 0" stroke="#4a5568" stroke-width="2"/></g>
                        </g>

                         <!-- Probe String -->
                        <g id="install-probe" class="installation-diagram-element" style="transform: translateY(-400px)">
                            <line x1="200" y1="50" x2="200" y2="400" stroke="#facc15" stroke-width="4" />
                            <rect x="190" y="370" width="20" height="30" fill="silver" stroke="#4a5568" rx="2"/>
                            <rect x="190" y="250" width="20" height="30" fill="silver" stroke="#4a5568" rx="2"/>
                        </g>

                        <!-- Data Logger -->
                        <g id="data-logger" class="installation-diagram-element" opacity="0">
                            <rect x="257.5" y="15" width="5" height="30" fill="#78716c"/>
                            <rect x="230" y="5" width="60" height="20" fill="#4b5563" rx="3"/>
                            <line x1="200" y1="50" x2="230" y2="15" stroke="#374151" stroke-width="2"/>
                        </g>

                   </svg>
                </div>
            </div>
        </div>
        
        <!-- Slide 5: Component Movement Analysis -->
        <div id="slide-5" class="slide">
            <div class="w-full max-w-full flex flex-col md:grid md:grid-cols-12 items-center justify-center gap-4 p-4 h-full">
                <!-- Left Column: Controls & Description -->
                <div class="md:col-span-3 w-full text-left flex flex-col h-full">
                    <h1 class="text-4xl font-bold text-gray-800">Component Movement</h1>
                    <div class="mt-6 flex flex-wrap gap-2">
                        <button data-component="movement-casing" class="component-button px-4 py-2 bg-gray-200 text-gray-800 font-semibold rounded-lg shadow text-sm">Casing</button>
                        <button data-component="movement-probe" class="component-button px-4 py-2 bg-gray-200 text-gray-800 font-semibold rounded-lg shadow text-sm">IPX Probes Chain</button>
                        <button data-component="movement-magnets" class="component-button px-4 py-2 bg-gray-200 text-gray-800 font-semibold rounded-lg shadow text-sm">Monitoring Magnet</button>
                        <button data-component="movement-datum" class="component-button px-4 py-2 bg-gray-200 text-gray-800 font-semibold rounded-lg shadow text-sm">Datum Magnet</button>
                    </div>
                    <div id="component-description" class="mt-4 text-base p-4 bg-gray-50 rounded-lg flex-grow">
                        <p class="text-gray-500">Select a component to see its description and use the slider to simulate movement.</p>
                    </div>
                </div>

                <!-- Center Column: Image -->
                <div id="component-image-container" class="md:col-span-5 w-full flex items-center justify-center h-full">
                     <!-- Image will be loaded here by JS -->
                </div>

                <!-- Right Column: Model & Slider -->
                <div class="md:col-span-4 w-full flex flex-col items-center justify-center h-full gap-4">
                    <svg id="movement-svg" viewBox="0 0 400 500" class="flex-grow w-full">
                        <rect x="0" y="50" width="400" height="450" fill="#a67b51"/>
                        <rect x="0" y="45" width="400" height="5" fill="#4d7c0f"/>
                        <rect x="150" y="50" width="100" height="450" fill="#6b4624"/>
                        <rect x="150" y="50" width="30" height="450" fill="#e5e7eb"/>
                        <rect x="220" y="50" width="30" height="450" fill="#e5e7eb"/>
                        
                        <g id="movement-magnets" class="installation-diagram-element">
                             <g transform="translate(200, 315)">
                                 <rect x="-25" y="-5" width="50" height="10" fill="#065f46" stroke="#4a5568"/>
                                 <path d="M -25 0 L -50 -25" stroke="#4a5568" stroke-width="2"/>
                                 <path d="M 25 0 L 50 -25" stroke="#4a5568" stroke-width="2"/>
                            </g>
                        </g>
                        
                        <rect id="movement-casing" class="installation-diagram-element" x="180" y="50" width="40" height="450" fill="#2563eb" stroke="#1e3a8a"/>
                        
                        <g id="movement-probe" class="installation-diagram-element">
                            <path id="cobra-rod" d="M 200 50 L 200 500" stroke="#facc15" stroke-width="4" fill="none"/>
                            <rect id="probe-sensor-1" x="190" y="450" width="20" height="30" fill="silver" stroke="#4a5568" rx="2"/>
                            <rect id="probe-sensor-2" x="190" y="300" width="20" height="30" fill="silver" stroke="#4a5568" rx="2"/>
                        </g>

                        <g id="movement-datum" class="installation-diagram-element" transform="translate(200, 485)">
                            <rect x="-25" y="-5" width="50" height="10" fill="#ef4444" stroke="#4a5568"/>
                            <path d="M -25 0 L -50 -25" stroke="#4a5568" stroke-width="2"/>
                            <path d="M 25 0 L 50 -25" stroke="#4a5568" stroke-width="2"/>
                        </g>

                    </svg>
                    <div class="w-full flex flex-col items-center mt-2">
                        <input id="movement-slider" type="range" min="0" max="100" value="0" class="w-3/4">
                        <div id="movement-slider-labels" class="w-3/4 flex justify-between text-sm font-semibold">
                            <span>No Load</span>
                            <span>Max Load</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 6: The Interactive Simulation -->
        <div id="slide-6" class="slide">
            <div class="w-full max-w-7xl bg-white rounded-2xl shadow-xl p-6 md:p-8 my-auto">
                <div class="flex flex-col gap-8">
                    <!-- Top Row: Model and Slider -->
                    <div class="flex flex-col md:flex-row gap-8 items-center">
                        <!-- Model -->
                        <div class="w-full md:w-3/4">
                            <div class="relative w-full border-2 border-gray-200 rounded-lg overflow-hidden" style="height: 500px;">
                                <div class="w-full flex flex-row text-center text-sm font-medium text-gray-700 absolute bottom-0 z-10" style="background-color: rgba(255, 255, 255, 0.7); padding: 2px 0; border-top: 1px solid rgba(0,0,0,0.1);">
                                    <div class="w-full">Uniform Clay Soil</div>
                                </div>
                                <svg id="simulation-svg" viewBox="0 0 800 500" class="absolute top-0 left-0 w-full h-full bg-white">
                                    <defs>
                                        <linearGradient id="soilGradient" x1="0%" y1="0%" x2="0%" y2="100%"><stop id="gradient-stop-top" offset="20%" stop-color="#a67b51" /><stop offset="100%" stop-color="#5a3d20" /></linearGradient>
                                        <linearGradient id="pipeGradient" x1="0%" y1="0%" x2="0%" y2="100%"><stop id="pipe-gradient-stop-top" offset="0%" stop-color="#52525b" /><stop offset="100%" stop-color="#52525b" /></linearGradient>
                                    </defs>
                                    <path id="soil-body" d="M 0 500 L 0 100 L 800 100 L 800 500 Z" fill="url(#soilGradient)" />
                                    <polygon id="embankment" points="300,100 500,100 550,100 250,100" fill="#a16207" stroke="#444" stroke-width="1.5" />
                                    <line id="bar-magnet-1" x1="385" y1="150" x2="385" y2="150" stroke="#f97316" stroke-width="4" style="transition: opacity 0.2s linear;" opacity="0"/><line id="bar-magnet-2" x1="385" y1="250" x2="385" y2="250" stroke="#f97316" stroke-width="4" style="transition: opacity 0.2s linear;" opacity="0"/><line id="bar-magnet-3" x1="385" y1="330" x2="385" y2="330" stroke="#f97316" stroke-width="4" style="transition: opacity 0.2s linear;" opacity="0"/>
                                    <rect id="extensometer-casing" x="397" y="100" width="6" height="400" fill="url(#pipeGradient)" rx="2" />
                                    <g id="magnet-1" class="magnet-group"><circle cx="400" cy="150" r="10" fill="#3b82f6" stroke="white" stroke-width="1.5" /><text x="400" y="154" class="magnet-label text-center" text-anchor="middle">1</text></g>
                                    <g id="magnet-2" class="magnet-group"><circle cx="400" cy="250" r="10" fill="#3b82f6" stroke="white" stroke-width="1.5" /><text x="400" y="254" class="magnet-label text-center" text-anchor="middle">2</text></g>
                                    <g id="magnet-3" class="magnet-group"><circle cx="400" cy="330" r="10" fill="#3b82f6" stroke="white" stroke-width="1.5" /><text x="400" y="334" class="magnet-label text-center" text-anchor="middle">3</text></g>
                                    <g id="datum-magnet" class="magnet-group"><circle cx="400" cy="420" r="12" fill="#ef4444" stroke="white" stroke-width="2" /><text x="400" y="424" class="magnet-label" text-anchor="middle">D</text></g>
                                </svg>
                            </div>
                        </div>
                        <!-- Slider -->
                        <div class="w-full md:w-1/4 flex flex-col items-center justify-center space-y-4">
                            <label for="load-slider" class="font-bold text-lg text-gray-700">Embankment Load</label>
                            <input id="load-slider" type="range" min="0" max="100" value="0" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                            <span id="load-value" class="font-mono text-xl font-bold text-indigo-600 bg-indigo-100 rounded-md px-3 py-1 w-28 text-center">0 %</span>
                        </div>
                    </div>
                    <!-- Bottom Row: Tables -->
                    <div class="flex flex-col md:flex-row gap-8 justify-center">
                        <div class="flex-1">
                            <div class="table-container">
                                <h2 class="text-xl font-bold text-gray-800 text-center mb-4">Probe Readings</h2>
                                <table class="data-table">
                                    <thead><tr><th>Probe</th><th class="text-right">Reading (mm)</th></tr></thead>
                                    <tbody>
                                        <tr><td>Magnet 1</td><td id="reading-1" class="font-mono font-bold text-right">0.0</td></tr>
                                        <tr><td>Magnet 2</td><td id="reading-2" class="font-mono font-bold text-right">0.0</td></tr>
                                        <tr><td>Magnet 3</td><td id="reading-3" class="font-mono font-bold text-right">0.0</td></tr>
                                        <tr><td>Datum</td><td id="reading-pipe" class="font-mono font-bold text-right text-green-700">0.0</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="flex-1">
                             <div class="table-container">
                                <h2 class="text-xl font-bold text-gray-800 text-center mb-4">Actual Physical Movement</h2>
                                <table class="data-table">
                                    <thead><tr><th>Point</th><th class="text-right">Movement (mm)</th></tr></thead>
                                    <tbody>
                                        <tr><td>Magnet 1</td><td id="actual-1" class="font-mono font-bold text-right">0.0</td></tr>
                                        <tr><td>Magnet 2</td><td id="actual-2" class="font-mono font-bold text-right">0.0</td></tr>
                                        <tr><td>Magnet 3</td><td id="actual-3" class="font-mono font-bold text-right">0.0</td></tr>
                                        <tr><td>Datum</td><td id="actual-datum" class="font-mono font-bold text-right">0.0</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Slide 7: Component Movement -->
        <div id="slide-7" class="slide">
            <div class="p-4 w-full max-w-6xl">
                <h1 class="text-5xl font-bold text-gray-800">Component Movement Under Load</h1>
                <div class="flex flex-col md:flex-row items-center justify-center gap-12 mt-8">
                    <!-- Diagram -->
                    <div class="w-full md:w-1/2">
                        <svg viewBox="0 0 400 450">
                            <!-- Ground -->
                            <rect x="50" y="50" width="300" height="400" fill="#a67b51" />
                            <rect x="50" y="45" width="300" height="5" fill="#4d7c0f"/>
                            
                            <!-- Casing -->
                            <rect x="190" y="50" width="20" height="400" fill="#2563eb" />
                            
                            <!-- Magnets -->
                            <rect x="180" y="100" width="40" height="10" fill="#065f46"/>
                            <rect x="180" y="200" width="40" height="10" fill="#065f46"/>
                            <rect x="180" y="300" width="40" height="10" fill="#065f46"/>
                             <!-- Datum -->
                            <rect x="175" y="400" width="50" height="15" fill="#ef4444"/>
                            <text x="200" y="430" text-anchor="middle" font-weight="bold">Datum (Fixed)</text>


                            <!-- Arrows -->
                            <g> <!-- Magnet 1 Arrow -->
                                <line x1="160" y1="105" y2="155" stroke="#dc2626" stroke-width="3"/>
                                <path d="M 155 145 L 160 155 L 165 145 Z" fill="#dc2626"/>
                            </g>
                             <g> <!-- Magnet 2 Arrow -->
                                <line x1="160" y1="205" y2="245" stroke="#dc2626" stroke-width="3"/>
                                <path d="M 155 235 L 160 245 L 165 235 Z" fill="#dc2626"/>
                            </g>
                             <g> <!-- Magnet 3 Arrow -->
                                <line x1="160" y1="305" y2="325" stroke="#dc2626" stroke-width="3"/>
                                <path d="M 155 315 L 160 325 L 165 315 Z" fill="#dc2626"/>
                            </g>
                            <g> <!-- Casing Arrow -->
                                <line x1="220" y1="50" y2="60" stroke="#16a34a" stroke-width="3"/>
                                <path d="M 215 55 L 220 65 L 225 55 Z" fill="#16a34a"/>
                            </g>
                        </svg>
                    </div>
                    <!-- Legend -->
                    <div class="w-full md:w-1/2 text-left">
                        <ul class="text-xl space-y-6">
                            <li class="flex items-center">
                                <svg width="40" height="20" class="mr-3"><line x1="0" y1="10" x2="40" y2="10" stroke="#dc2626" stroke-width="3"/></svg>
                                <span class="font-bold text-red-600">Soil & Spider Magnets:</span>&nbsp;Move DOWNWARD due to compression. Movement is greatest near the surface.
                            </li>
                            <li class="flex items-center">
                                <svg width="40" height="20" class="mr-3"><line x1="0" y1="10" x2="40" y2="10" stroke="#16a34a" stroke-width="3"/></svg>
                                <span class="font-bold text-green-600">Extensometer Casing:</span>&nbsp;Pushed DOWNWARD by the load, penetrating the soil slightly.
                            </li>
                             <li class="flex items-center">
                                <svg width="40" height="20" class="mr-3"><rect x="0" y="0" width="20" height="20" fill="#ef4444"/></svg>
                                <span class="font-bold text-gray-700">Datum Anchor:</span>&nbsp;Remains STATIONARY, acting as the fixed reference point for all measurements.
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 8: Conclusion -->
        <div id="slide-8" class="slide">
            <div class="p-4">
                <h1 class="text-5xl font-bold text-gray-800">Summary of Observations</h1>
                <ul class="mt-8 text-xl text-left list-disc space-y-4 max-w-3xl">
                    <li>The greatest physical settlement occurs at the surface (Magnet 1) and decreases with depth.</li>
                    <li>The probe readings for the magnets are negative because the soil settlement is greater than the pipe's downward movement.</li>
                    <li>The probe reading for the Datum is positive, showing the slight downward penetration of the pipe relative to the fixed anchor.</li>
                    <li>This simulation highlights the difference between <span class="font-bold text-indigo-600">instrument readings (relative)</span> and <span class="font-bold text-green-700">actual physical settlement (absolute)</span>.</li>
                </ul>
            </div>
        </div>
    </main>

    <!-- Navigation -->
    <button id="prev" class="nav-button">Previous</button>
    <button id="next" class="nav-button">Next</button>

    <script defer>
        document.addEventListener('DOMContentLoaded', () => {
            // --- PRESENTATION LOGIC ---
            let currentSlide = 1;
            const totalSlides = 8;
            const prevButton = document.getElementById('prev');
            const nextButton = document.getElementById('next');

            function showSlide(slideNumber) {
                document.querySelectorAll('.slide').forEach(slide => slide.classList.remove('active'));
                document.getElementById(`slide-${slideNumber}`).classList.add('active');
                
                prevButton.style.display = slideNumber === 1 ? 'none' : 'block';
                nextButton.style.display = slideNumber === totalSlides ? 'none' : 'block';
            }

            prevButton.addEventListener('click', () => {
                if (currentSlide > 1) {
                    currentSlide--;
                    showSlide(currentSlide);
                }
            });

            nextButton.addEventListener('click', () => {
                if (currentSlide < totalSlides) {
                    currentSlide++;
                    showSlide(currentSlide);
                }
            });
            
            showSlide(currentSlide);

            // --- PROBE SLIDE INTERACTIVITY ---
            const probeSvg = document.getElementById('probe-svg');
            const draggableMagnet = document.getElementById('draggable-magnet');
            const probeReadout = document.getElementById('probe-readout');
            let isDragging = false;
            
            const sensorTopY = 150;
            const sensorRange = 400;

            draggableMagnet.addEventListener('mousedown', (e) => {
                isDragging = true;
                draggableMagnet.style.cursor = 'grabbing';
            });

            probeSvg.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                const CTM = probeSvg.getScreenCTM();
                let newY = (e.clientY - CTM.f) / CTM.d;

                newY = Math.max(50 + 15, Math.min(newY, 650 - 15));
                draggableMagnet.setAttribute('transform', `translate(0, ${newY - 150})`);
                
                const reading = newY - sensorTopY;
                if (reading >= 0 && reading <= sensorRange) {
                    probeReadout.textContent = `${reading.toFixed(0)} mm`;
                } else {
                    probeReadout.textContent = 'Out of Range';
                }
            });

            window.addEventListener('mouseup', () => {
                isDragging = false;
                draggableMagnet.style.cursor = 'grab';
            });
            
            // --- INSTALLATION SLIDE LOGIC ---
            const installPrev = document.getElementById('prev-install-step');
            const installNext = document.getElementById('next-install-step');
            let installStep = 1;
            const totalInstallSteps = 4;

            const drill = document.getElementById('drill');
            const installCasing = document.getElementById('install-casing');
            const groutLeft = document.getElementById('grout-left');
            const groutRight = document.getElementById('grout-right');
            const installTool = document.getElementById('install-tool');
            const installProbe = document.getElementById('install-probe');
            const leg1Left = document.getElementById('leg-1-left');
            const leg1Right = document.getElementById('leg-1-right');
            const leg2Left = document.getElementById('leg-2-left');
            const leg2Right = document.getElementById('leg-2-right');
            const deployedMagnets = document.getElementById('deployed-magnets');
            const dataLogger = document.getElementById('data-logger');


            function showInstallStep(step) {
                document.querySelectorAll('.installation-step-description').forEach(s => s.classList.remove('active'));
                document.getElementById(`step-desc-${step}`).classList.add('active');

                installPrev.disabled = step === 1;
                installNext.disabled = step === totalInstallSteps;
                installPrev.style.opacity = step === 1 ? 0.5 : 1;
                installNext.style.opacity = step === totalInstallSteps ? 0.5 : 1;

                drill.style.transform = (step === 1) ? 'translate(200, 50px)' : 'translate(200, -100px)';
                installCasing.style.transform = (step >= 2) ? 'translateY(0px)' : 'translateY(-400px)';
                groutLeft.style.opacity = (step >= 2) ? '1' : '0';
                groutRight.style.opacity = (step >= 2) ? '1' : '0';
                installTool.style.opacity = (step === 3) ? '1' : '0';
                installTool.style.transform = (step === 3) ? 'translate(200, 50px)' : 'translate(200, -350px)';
                const deployLegs = step >= 3;
                leg1Left.setAttribute('d', deployLegs ? 'M -15 0 L -75 0' : 'M -15 0 L -25 0');
                leg1Right.setAttribute('d', deployLegs ? 'M 15 0 L 75 0' : 'M 15 0 L 25 0');
                leg2Left.setAttribute('d', deployLegs ? 'M -15 0 L -75 0' : 'M -15 0 L -25 0');
                leg2Right.setAttribute('d', deployLegs ? 'M 15 0 L 75 0' : 'M 15 0 L 25 0');
                deployedMagnets.style.opacity = (step >= 3) ? '1' : '0';
                if (step < 3) deployedMagnets.style.opacity = '0';
                installProbe.style.transform = (step === 4) ? 'translateY(0px)' : 'translateY(-400px)';
                dataLogger.style.opacity = (step === 4) ? '1' : '0';
            }

            installPrev.addEventListener('click', () => {
                if(installStep > 1) {
                    installStep--;
                    showInstallStep(installStep);
                }
            });
            installNext.addEventListener('click', () => {
                if(installStep < totalInstallSteps) {
                    installStep++;
                    showInstallStep(installStep);
                }
            });
            showInstallStep(installStep);
            
            // --- COMPONENT MOVEMENT SLIDE LOGIC ---
            const componentButtons = document.querySelectorAll('.component-button');
            const movementSlider = document.getElementById('movement-slider');
            const movementCasing = document.getElementById('movement-casing');
            const movementMagnets = document.getElementById('movement-magnets');
            const movementProbe = document.getElementById('movement-probe');
            const cobraRod = document.getElementById('cobra-rod');
            const probeSensor1 = document.getElementById('probe-sensor-1');
            const probeSensor2 = document.getElementById('probe-sensor-2');
            const movementDatum = document.getElementById('movement-datum');
            const componentDescription = document.getElementById('component-description');
            const componentImageContainer = document.getElementById('component-image-container');
            const movementSliderLabels = document.getElementById('movement-slider-labels');
            let activeComponentId = null;

            const descriptions = {
                'movement-casing': {
                    img: 'casing_image.png',
                    text: `<h3 class="font-bold text-xl mb-2">Casing Movement</h3><p>During installation, the pipe's stick-up is typically cut below ground level and sealed. The area is then backfilled with material to reduce direct force on the pipe.</p><p class="mt-2">However, if this is not done correctly, the pipe will receive direct force from any surface load, causing it to be pushed down slightly. The actual downward movement of the pipe can be measured relative to the fixed Datum Magnet. This movement is often considered an error and can be disregarded from the true soil settlement readings.</p>`
                },
                'movement-probe': {
                    img: 'probe_chain_image.png',
                    text: `<h3 class="font-bold text-xl mb-2">IPX Probes Chain (Cobra Rod)</h3><p>The IPX sensors are attached to a semi-rigid rod (cobra) which sits on the base of the casing and moves with it. Ideally, the top of this rod is cut lower than the casing top to avoid contact with backfill material.</p><p class="mt-2">If backfill loads the cobra rod, it can deform into a <span class="font-bold">wavy shape</span>. This moves the probes inside the casing and produces erroneous readings, which often appear as sudden, simultaneous jumps in the data.</p>`
                },
                'movement-magnets': {
                    img: 'monitoring_magnet_image.png',
                    text: `<h3 class="font-bold text-xl mb-2">Monitoring Magnet Movement</h3><p>The monitoring magnet is directly coupled to the surrounding soil via its spider legs. It is the primary sensor for measuring ground movement.</p><p class="mt-2">It will move <span class="font-bold">downward (settlement)</span> when a load is applied (e.g., from an embankment) or <span class="font-bold">upward (heave)</span> when a load is removed (e.g., during excavation).</p>`
                },
                'movement-datum': {
                    img: 'monitoring_magnet_image.png',
                    text: `<h3 class="font-bold text-xl mb-2">Datum Magnet</h3><p>The Datum Magnet is anchored in stable ground, deep below the zone of influence from surface loads. It acts as a <span class="font-bold">fixed, stationary reference point</span> (a benchmark).</p><p class="mt-2">All other measurements are calculated relative to this point. In an ideal installation, the Datum Magnet should show no movement.</p>`
                }
            };

            componentButtons.forEach(button => {
                button.addEventListener('click', () => {
                    componentButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    activeComponentId = button.dataset.component;

                    [movementCasing, movementProbe, movementMagnets, movementDatum].forEach(el => {
                        if (el) { 
                            el.classList.remove('highlighted-component');
                            el.style.transform = '';
                        }
                    });
                   
                    cobraRod.setAttribute('d', 'M 200 50 L 200 500');
                    probeSensor1.setAttribute('transform', '');
                    probeSensor2.setAttribute('transform', '');
                    
                    const componentToShow = document.getElementById(activeComponentId);
                    if(componentToShow) componentToShow.classList.add('highlighted-component');
                    
                    const content = descriptions[activeComponentId];
                    if (content) {
                        componentImageContainer.innerHTML = `<img src="${content.img}" class="mx-auto my-2 rounded-lg shadow-md max-h-full object-contain">`;
                        componentDescription.innerHTML = content.text;
                    } else {
                        componentImageContainer.innerHTML = '';
                        componentDescription.innerHTML = '<p class="text-gray-500">Select a component to see its description and use the slider to simulate movement.</p>';
                    }
                    
                    const isMagnet = activeComponentId === 'movement-magnets';
                    movementSlider.min = isMagnet ? -100 : 0;
                    movementSlider.value = 0;
                    movementSliderLabels.innerHTML = isMagnet ? `<span>Heave</span><span>Settlement</span>` : `<span>No Load</span><span>Max Load</span>`;

                    movementSlider.dispatchEvent(new Event('input'));
                });
            });

            movementSlider.addEventListener('input', (e) => {
                const value = parseInt(e.target.value);
                const settlementFactor = value / 100;
                const maxMove = 40;
                const moveDistance = maxMove * settlementFactor;
                
                movementMagnets.style.transform = '';
                movementCasing.style.transform = '';
                movementProbe.style.transform = '';
                cobraRod.setAttribute('d', 'M 200 50 L 200 500');
                probeSensor1.setAttribute('transform', '');
                probeSensor2.setAttribute('transform', '');

                
                switch (activeComponentId) {
                    case 'movement-casing':
                        const casingMove = moveDistance * 0.1;
                        movementCasing.style.transform = `translateY(${casingMove}px)`;
                        movementProbe.style.transform = `translateY(${casingMove}px)`;
                        break;
                    case 'movement-probe':
                        const deformationFactor = Math.abs(value) / 100;
                        const amplitude = 15 * deformationFactor;
                        let pathData = 'M 200 50 C ';
                        const control_y1 = 50 + (450 / 4);
                        const control_y2 = 50 + (450 / 4) * 3;
                        const x_offset = amplitude * 2;
                        pathData += `${200 - x_offset} ${control_y1}, ${200 + x_offset} ${control_y2}, 200 500`;
                        cobraRod.setAttribute('d', pathData);
                        const sag = moveDistance > 0 ? moveDistance * 0.2 : 0;
                        movementProbe.style.transform = `translateY(${sag}px)`;
                        break;
                    case 'movement-magnets':
                        movementMagnets.style.transform = `translateY(${moveDistance}px)`;
                        break;
                }
            });


            // --- SIMULATION LOGIC ---
            const simSlider = document.getElementById('load-slider');
            const simLoadValue = document.getElementById('load-value');
            const simSoilBody = document.getElementById('soil-body');
            const simEmbankment = document.getElementById('embankment');
            const simGradientStopTop = document.getElementById('gradient-stop-top');
            const simPipeGradientStopTop = document.getElementById('pipe-gradient-stop-top');
            const simExtensometerCasing = document.getElementById('extensometer-casing');
            const simMagnet1 = document.getElementById('magnet-1');
            const simMagnet2 = document.getElementById('magnet-2');
            const simMagnet3 = document.getElementById('magnet-3');
            const simReading1 = document.getElementById('reading-1');
            const simReading2 = document.getElementById('reading-2');
            const simReading3 = document.getElementById('reading-3');
            const simReadingPipe = document.getElementById('reading-pipe');
            const simActual1 = document.getElementById('actual-1');
            const simActual2 = document.getElementById('actual-2');
            const simActual3 = document.getElementById('actual-3');
            const simActualDatum = document.getElementById('actual-datum');
            const simBarMagnet1 = document.getElementById('bar-magnet-1');
            const simBarMagnet2 = document.getElementById('bar-magnet-2');
            const simBarMagnet3 = document.getElementById('bar-magnet-3');
            
            const numPoints = 100;
            const initialGroundLevelY = 100;
            const svgHeight = 500;
            const svgWidth = 800;
            const maxSettlement = 37;
            const maxPenetration = 1;

            simSlider.addEventListener('input', (event) => {
                const load = parseInt(event.target.value);
                const loadFactor = load / 100;
                simLoadValue.textContent = `${load} %`;
                const surfacePoints = [];
                const surfaceYCoords = [];
                for (let i = 0; i <= numPoints; i++) {
                    const position = i / numPoints;
                    const distanceFromCenter = Math.abs(position - 0.5);
                    const influenceSpread = 0.18;
                    const influence = Math.exp(-Math.pow(distanceFromCenter / influenceSpread, 2));
                    const settlement = maxSettlement * influence * loadFactor;
                    const x = position * svgWidth;
                    const y = initialGroundLevelY + settlement;
                    surfacePoints.push([x,y]);
                    surfaceYCoords.push(y);
                }
                const pathPoints = surfacePoints.map(p => `${p[0]},${p[1]}`);
                const pathD = `M 0,${svgHeight} L 0,${surfaceYCoords[0]} L ${pathPoints.join(' L ')} L ${svgWidth},${svgHeight} Z`;
                simSoilBody.setAttribute('d', pathD);
                const baseSoilColor = { h: 30, s: 45, l: 55 };
                const stressSoilColor = { h: 120, s: 60, l: 45 };
                const soilColorFactor = Math.min(1, loadFactor * 1.5);
                const newSoilHue = baseSoilColor.h * (1 - soilColorFactor) + stressSoilColor.h * soilColorFactor;
                const newSoilSat = baseSoilColor.s * (1 - soilColorFactor) + stressSoilColor.s * soilColorFactor;
                const newSoilLight = baseSoilColor.l * (1 - soilColorFactor) + stressSoilColor.l * soilColorFactor;
                simGradientStopTop.setAttribute('stop-color', `hsl(${newSoilHue}, ${newSoilSat}%, ${newSoilLight}%)`);
                const embankmentHeight = 50 * loadFactor;
                const leftBaseIndex = Math.floor(numPoints * 0.25);
                const rightBaseIndex = Math.floor(numPoints * 0.75);
                const embankmentTopLeft = [svgWidth * 0.25 + 50, surfaceYCoords[leftBaseIndex] - embankmentHeight];
                const embankmentTopRight = [svgWidth * 0.75 - 50, surfaceYCoords[rightBaseIndex] - embankmentHeight];
                const embankmentBasePoints = surfacePoints.slice(leftBaseIndex, rightBaseIndex + 1);
                const allEmbankmentPoints = [embankmentTopLeft, embankmentTopRight, ...embankmentBasePoints.reverse()];
                const embankmentPointsStr = allEmbankmentPoints.map(p => p.join(',')).join(' ');
                simEmbankment.setAttribute('points', embankmentPointsStr);
                const penetration = maxPenetration * loadFactor;
                simExtensometerCasing.setAttribute('transform', `translate(0, ${penetration})`);
                const basePipeColor = { r: 82, g: 82, b: 91 };
                const stressPipeColor = { r: 185, g: 28, b: 28 };
                const pipeColorFactor = loadFactor;
                const newPipeR = basePipeColor.r * (1 - pipeColorFactor) + stressPipeColor.r * pipeColorFactor;
                const newPipeG = basePipeColor.g * (1 - pipeColorFactor) + stressPipeColor.g * pipeColorFactor;
                const newPipeB = basePipeColor.b * (1 - pipeColorFactor) + stressPipeColor.b * pipeColorFactor;
                simPipeGradientStopTop.setAttribute('stop-color', `rgb(${newPipeR}, ${newPipeG}, ${newPipeB})`);
                const centerIndex = Math.floor(numPoints / 2);
                const centerSettlement = surfaceYCoords[centerIndex] - initialGroundLevelY;
                const s1_abs = centerSettlement * 0.95;
                const s2_abs = centerSettlement * 0.65;
                const s3_abs = centerSettlement * 0.35;
                simMagnet1.setAttribute('transform', `translate(0, ${s1_abs})`);
                simMagnet2.setAttribute('transform', `translate(0, ${s2_abs})`);
                simMagnet3.setAttribute('transform', `translate(0, ${s3_abs})`);
                simReading1.textContent = (penetration - s1_abs).toFixed(1);
                simReading2.textContent = (penetration - s2_abs).toFixed(1);
                simReading3.textContent = (penetration - s3_abs).toFixed(1);
                simReadingPipe.textContent = `+${penetration.toFixed(1)}`;
                simReading1.style.color = (penetration - s1_abs) < 0 ? '#dc2626' : '#166534';
                simReading2.style.color = (penetration - s2_abs) < 0 ? '#dc2626' : '#166534';
                simReading3.style.color = (penetration - s3_abs) < 0 ? '#dc2626' : '#166534';
                simActual1.textContent = `-${s1_abs.toFixed(1)}`;
                simActual2.textContent = `-${s2_abs.toFixed(1)}`;
                simActual3.textContent = `-${s3_abs.toFixed(1)}`;
                simActualDatum.textContent = `0.0`;
                simBarMagnet1.setAttribute('y2', 150 + s1_abs);
                simBarMagnet2.setAttribute('y2', 250 + s2_abs);
                simBarMagnet3.setAttribute('y2', 330 + s3_abs);
                const barOpacity = load > 2 ? 0.8 : 0;
                simBarMagnet1.style.opacity = barOpacity;
                simBarMagnet2.style.opacity = barOpacity;
                simBarMagnet3.style.opacity = barOpacity;
            });
            simSlider.dispatchEvent(new Event('input'));

        });
    </script>
</body>
</html>

